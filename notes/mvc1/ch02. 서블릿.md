## `Jar` VS `War`
- Jar와 War는 모두 자바 클래스 패키징 확장자로 **프로젝트를 배포할 때 사용한다.**
- Jar는 JDK(Java Development Kit)에 포함된 JRE(Java RuntimeEnvironment)만 있으면 실행이 가능하다.
- War는 웹 에플리케이션 전용 패키징으로 `WEB-INF`, `META-INF`로 사전 정의된 구조를 사용하여 War를 실행하기 위해서는 웹 서버 또는 WAS가 필요하다.

## 서블릿
### 스프링 부트 서블릿 환경 구성
`@ServletComponentScan`: 스프링 부트는 서블릿을 직접 등록해서 사용할 수 있다.

```java
@ServletComponentScan
@SpringBootApplication
public class ServletApplication {
    
    public static void main(String[] args) {
	    SpringApplication.run(ServletApplication.class, args);
    }
}
```

### 서블릿 등록하기
```java
@WebServlet(name = "helloServlet", urlPatterns = "/hello")
public class HelloServlet extends HttpServlet {
    
    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        
        System.out.println("HelloServlet.service");
        System.out.println("request = " + request);
        System.out.println("response = " + response);
        
        String username = request.getParameter("username");
        
        System.out.println("username = " + username);
        response.setContentType("text/plain");
        response.setCharacterEncoding("utf-8");
        response.getWriter().write("hello " + username);
    }
}
```
`@WebServlet`: 서블릿 애노테이션으로, `name` 에는 서블릿의 이름을 넣고 `urlPatterns` 에는 URL mapping 정보를 넣는다.  
HTTP 요청을 통해 매핑된 URL이 호출되면 서블릿 컨테이너는 다음 메서드를 실행한다.  
```java
protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { ... }
```

#### 콘솔 실행 결과
```text
HelloServlet.service
request = org.apache.catalina.connector.RequestFacade@5e4e72
response = org.apache.catalina.connector.ResponseFacade@37d112b6
username = world
```

#### HTTP 요청 메시지 로그로 확인하기
`application.properties`에 다음 설정을 추가한다.
```text
logging.level.org.apache.coyoete.http11=debug
```

## 서블릿 컨테이너 동작 방식
![내장 톰캣 서버 생성.png](imgs%2F%EB%82%B4%EC%9E%A5%20%ED%86%B0%EC%BA%A3%20%EC%84%9C%EB%B2%84%20%EC%83%9D%EC%84%B1.png)
1. 스프링 부트는 내장 톰캣 서버를 실행한다.
2. 내장 톰캣 서버는 서블릿 컨테이너에 `helloServlet` 을 생성한다.
3. 웹 브라우저는 다음과 같은 요청 메시지를 웹 애플리케이션 서버에 전송한다.
![HTTP 요청, 응답 메시지.png](imgs%2FHTTP%20%EC%9A%94%EC%B2%AD%2C%20%EC%9D%91%EB%8B%B5%20%EB%A9%94%EC%8B%9C%EC%A7%80.png)
4. 웹 애플리케이션 서버는 **HTTP 요청 메시지를 기반으로 request, response 객체를 만들고, helloServlet 을 실행한다.**
5. helloServlet 에서는 **response 객체를 변경한다.**
6. 웹 애플리케이션 서버는 변경된 response 객체 정보로 HTTP 응답을 생성하여 웹 브라우저에 전송한다.
![웹 애플리케이션 서버의 요청 응답 구조.png](imgs%2F%EC%9B%B9%20%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98%20%EC%84%9C%EB%B2%84%EC%9D%98%20%EC%9A%94%EC%B2%AD%20%EC%9D%91%EB%8B%B5%20%EA%B5%AC%EC%A1%B0.png)

