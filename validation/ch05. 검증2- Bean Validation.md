## Bean Validation ì†Œê°œ
- íŠ¹ì •í•œ êµ¬í˜„ì²´ê°€ ì•„ë‹ˆë¼ Bean Validation 2.0(JSR-380)ì´ë¼ëŠ” ê¸°ìˆ  í‘œì¤€ì´ë‹¤. ì¦‰, ê²€ì¦ ì• ë…¸í…Œì´ì…˜ê³¼ ì—¬ëŸ¬ ì¸í„°í˜ì´ìŠ¤ì˜ ëª¨ìŒì´ë‹¤. (ë§ˆì¹˜ JPAê°€ í‘œì¤€ ê¸°ìˆ ì´ê³  ê·¸ êµ¬í˜„ì²´ë¡œ í•˜ì´ë²„ë„¤ì´íŠ¸ê°€ ìˆëŠ” ê²ƒê³¼ ê°™ë‹¤.)
- êµ¬í˜„í•œ ê¸°ìˆ  ì¤‘ì— ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” êµ¬í˜„ì²´ëŠ” í•˜ì´ë²„ë„¤ì´í¬ Validatorì´ë‹¤. (ORMê³¼ëŠ” ê´€ë ¨ì´ ì—†ë‹¤.)
- ê²€ì¦ ë¡œì§ì„ ëª¨ë“  í”„ë¡œì íŠ¸ì— ì ìš©í•  ìˆ˜ ìˆê²Œ ê³µí†µí™”í•˜ê³  í‘œì¤€í™” í•œ ê²ƒ

> **ğŸ€ í•˜ì´ë²„ë„¤ì´íŠ¸ Validator ê´€ë ¨ ë§í¬**  
> - [ê³µì‹ ì‚¬ì´íŠ¸](http://hibernate.org/validator/)
> - [ê³µì‹ ë©”ë‰´ì–¼](https://docs.jboss.org/hibernate/validator/6.2/reference/en-US/html_single/)
> - [ê²€ì¦ ì• ë…¸í…Œì´ì…˜ ëª¨ìŒ](https://docs.jboss.org/hibernate/validator/6.2/reference/en-US/html_single/#validator-defineconstraints-spec)

## ìˆœìˆ˜í•œ Bean Validation ì‚¬ìš©ë²•
### Bean Validation ì˜ì¡´ê´€ê³„ ì¶”ê°€
```properties
[build.gradle]

implementation 'org.springframework.boot:spring-boot-starter-validation'
```
`spring-boot-starter-validation` ì˜ì¡´ê´€ê³„ë¥¼ ì¶”ê°€í•˜ë©´ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¶”ê°€ëœë‹¤.
#### Jakarta Bean Validation
- `jakarta.validation-api`: Bean Validation ì¸í„°í˜ì´ìŠ¤
- `hibernate-validator`: êµ¬í˜„ì²´

### í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
1. `Item.class` ìˆ˜ì •í•˜ê¸°
```java
@Data
public class Item {

    private Long id;
    
    @NotBlank
    private String itemName;
    
    @NotBlank
    @Range(min = 1_000, max = 1_000_000)
    private Integer price;
    
    @NotNull
    @Max(9_999)
    private Integer quantity;

    public Item() {
    }

    public Item(String itemName, Integer price, Integer quantity) {
        this.itemName = itemName;
        this.price = price;
        this.quantity = quantity;
    }
}
```
**ê²€ì¦ ì• ë…¸í…Œì´ì…˜**
- `@NotBlank`: ë¹ˆê°’ + ê³µë°±ë§Œ ìˆëŠ” ê²½ìš°ë¥¼ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- `@NotNull`: `null`ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- `@Range(min = 1, max = 100)`: ë²”ìœ„ ì•ˆì˜ ê°’ì´ì–´ì•¼ í•œë‹¤.
- `@Max(999)`: í•´ë‹¹ ìˆ«ì ì´ìƒì˜ ê°’ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

> ğŸ€ì°¸ê³   
> `javax.validation.constraints.NotNull`  
> `org.hibernate.validator.constraints.Range`  
>   
> `javax.validation`ìœ¼ë¡œ ì‹œì‘í•˜ë©´ íŠ¹ì • êµ¬í˜„ì— ê´€ê³„ì—†ì´ ì œê³µë˜ëŠ” í‘œì¤€ ì¸í„°í˜ì´ìŠ¤ì´ê³ ,   
> `org.hibernate.validator`ë¡œ ì‹œì‘í•˜ë©´ í•˜ì´ë²„ë„¤ì´íŠ¸ validator êµ¬í˜„ì²´ë¥¼ ì‚¬ìš©í•  ë•Œë§Œ ì œê³µë˜ëŠ” ê²€ì¦ê¸°ëŠ¥ì´ë‹¤.
2. BeanValidationTest - Bean Validation í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±
```java
public class BeanValidationTest {

    @Test
    void beanValidation() {
        // ê²€ì¦ê¸° ìƒì„±
        ValidatorFactory factory = Validation.buildDefaultValidatorFactory();
        Validator validator = factory.getValidator();

        Item item = new Item();
        item.setItemName("   ");
        item.setPrice(0);
        item.setQuantity(10_000);

        // ê²€ì¦ ì‹¤í–‰
        Set<ConstraintViolation<Item>> violations = validator.validate(item);

        for (ConstraintViolation<Item> violation : violations) {
            System.out.println("violation = " + violation);
            System.out.println("violation.message = " + violation.getMessage());
        }
    }
}
```
- ê²€ì¦ ì‹¤í–‰
  - ê²€ì¦ ëŒ€ìƒ(`item`)ì„ ì§ì ‘ ê²€ì¦ê¸°ì— ë„£ê³  ê·¸ ê²°ê³¼ë¥¼ ë°›ëŠ”ë‹¤. `Set`ì—ëŠ” `ConstraintViolation`ì´ë¼ëŠ” ê²€ì¦ ì˜¤ë¥˜ê°€ ë‹´ê¸´ë‹¤.
ë”°ë¼ì„œ ê²°ê³¼ê°€ ë¹„ì–´ìˆìœ¼ë©´ ê²€ì¦ ì˜¤ë¥˜ê°€ ì—†ëŠ” ê²ƒì´ë‹¤.
- ì‹¤í–‰ ê²°ê³¼
    ```text
    violation={interpolatedMessage='ê³µë°±ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤', propertyPath=itemName, rootBeanClass=class hello.itemservice.domain.item.Item, messageTemplate='{javax.validation.constraints.NotBlank.message}'}
    violation.message=ê³µë°±ì¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤
    
    violation={interpolatedMessage='9999 ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤', propertyPath=quantity, rootBeanClass=class hello.itemservice.domain.item.Item, messageTemplate='{javax.validation.constraints.Max.message}'}
    violation.message=9999 ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤
    
    violation={interpolatedMessage='1000ì—ì„œ 1000000 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤', propertyPath=price, rootBeanClass=class hello.itemservice.domain.item.Item, messageTemplate='{org.hibernate.validator.constraints.Range.message}'}
    violation.message=1000ì—ì„œ 1000000 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤
    ```
    - `ConstraintViolation` ì¶œë ¥ ê²°ê³¼ë¥¼ ë³´ë©´, ê²€ì¦ ì˜¤ë¥˜ê°€ ë°œìƒí•œ ê°ì²´, í•„ë“œ, ë©”ì‹œì§€ ì •ë³´ ë“± ë‹¤ì–‘í•œ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

> ğŸ€ ì°¸ê³   
> íŠ¹ì • í•„ë“œì˜ ë²”ìœ„ë¥¼ ë„˜ì–´ì„œëŠ” ê²€ì¦(ê°€ê²© * ìˆ˜ëŸ‰ì˜ í•©ì€ 10,000ì› ì´ìƒ) ê¸°ëŠ¥ì´ ë¹ ì¡ŒëŠ”ë°, ì´ ë¶€ë¶„ì€ ë’¤ì—ì„œ ì„¤ëª…í•œë‹¤.

## ìŠ¤í”„ë§ Bean Validation ì ìš©
### ìŠ¤í”„ë§ MVCëŠ” ì–´ë–»ê²Œ Bean Validatorë¥¼ ì‚¬ìš©í• ê¹Œ?
- ìŠ¤í”„ë§ ë¶€íŠ¸ê°€ `spring-boot-starter-validation` ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë„£ìœ¼ë©´ ìë™ìœ¼ë¡œ Bean Validatorë¥¼ ì¸ì§€í•˜ê³  ìŠ¤í”„ë§ì— í†µí•©í•œë‹¤.
- ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ìë™ìœ¼ë¡œ ê¸€ë¡œë²Œ Validatorë¡œ ë“±ë¡í•œë‹¤.
  - `LocalValidatorFactoryBean`ì„ ê¸€ë¡œë²Œ Validatorë¡œ ë“±ë¡í•œë‹¤. ì´ ValidatorëŠ” `@NotNull`ê°™ì€ ì• ë…¸í…Œì´ì…˜ì„ ë³´ê³  ê²€ì¦ì„ ìˆ˜í–‰í•œë‹¤.
ì´ë ‡ê²Œ ê¸€ë¡œë²Œ Validatorê°€ ì ìš©ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, `@Valid`, `@Validated`ë§Œ ì ìš©í•˜ë©´ ëœë‹¤.
  - ê²€ì¦ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´, `FieldError`, `ObjectError`ë¥¼ ìƒì„±í•´ì„œ `BindingResult`ì— ë‹´ì•„ì¤€ë‹¤.

> ğŸš¨ ì£¼ì˜  
> ì§ì ‘ ê¸€ë¡œë²Œ Validatorë¥¼ ì§ì ‘ ë“±ë¡í•˜ë©´ ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” Bean Validatorë¥¼ ê¸€ë¡œë²Œ `Validator`ë¡œ ë“±ë¡í•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ì• ë…¸í…Œì´ì…˜ ê¸°ë°˜ì˜ ë¹ˆ ê²€ì¦ê¸°ê°€ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.

> ğŸ€ ì°¸ê³   
> ê²€ì¦ ì‹œ `@Validated`, `@Valid` ë‘˜ë‹¤ ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤.  
> `javax.validation.@Valid`ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ `build.gradle`ì— ì˜ì¡´ê´€ê³„ ì¶”ê°€ê°€ í•„ìš”í•˜ë‹¤.  
> `@Validated`ëŠ” ìŠ¤í”„ë§ ì „ìš© ê²€ì¦ ì• ë…¸í…Œì´ì…˜ì´ê³ , `@Valid`ëŠ” ìë°” í‘œì¤€ ê²€ì¦ ì• ë…¸í…Œì´ì…˜ì´ë‹¤. ë‘˜ì¤‘ ì•„ë¬´ê±°ë‚˜ ì‚¬ìš©í•´ë„ ë™ì¼í•˜ê²Œ ì‘ë™í•˜ì§€ë§Œ, `@Validated`ëŠ” ë‚´ë¶€ì— `groups`ë¼ëŠ” ê¸°ëŠ¥ì„ í¬í•¨í•˜ê³  ìˆë‹¤. (groupsëŠ” ë’¤ì—ì„œ ì„¤ëª…í•œë‹¤.)

### ê²€ì¦ ìˆœì„œ
1. `@ModelAttribute` ê°ê°ì˜ í•„ë“œì— íƒ€ì… ë³€í™˜ ì‹œë„
   1. ì„±ê³µí•˜ë©´ ë‹¤ìŒìœ¼ë¡œ
   2. ì‹¤íŒ¨í•˜ë©´ `typeMismatch`ë¡œ `FieldError` ì¶”ê°€ 
2. Validator ì ìš©

### ë°”ì¸ë”©ì— ì„±ê³µí•œ í•„ë“œë§Œ Bean Validation ì ìš©
BeanValidatorëŠ” ë°”ì¸ë”©ì— ì‹¤íŒ¨í•œ í•„ë“œëŠ” BeanValidationì„ ì ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.  
`@ModelAttribute` -> ê°ê°ì˜ í•„ë“œ íƒ€ì… ë³€í™˜ì‹œë„ -> **ë³€í™˜ì— ì„±ê³µí•œ í•„ë“œë§Œ BeanValidation ì ìš©**  
